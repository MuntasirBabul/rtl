###########################################################################
#									  #
# File Name: 	Makefile						  #
# Description:  UVM flow makefile					  #
# Engineer:	Muntasir Babul						  #
#									  #
#									  #
#									  #			
###########################################################################

###########################################################################
### LIST OF VARIABLES #####################################################
### USE THESE VARIABLES ONLY TO ASSIGN FILES ##############################
###########################################################################

PROJECT_NAME		= AXI_PROJECT									
NO_OF_TRANSACTIONS 	= 2000
TB_TOP 			= axi_tb_top
UVM_TESTNAME 		= axi_test
UVM_VERBOSITY 		= UVM_LOW
UVM			= -L uvm
LOG 			= log
REPORT_DIR 		=
TIMESCALE		= -timescale 1ns/1ps

###########################################################################
### LIST OF VARIABLES #####################################################
### USE THESE VARIABLES ONLY TO ASSIGN FILE PATH ##########################
###########################################################################

AGENT_FP		= ../verif/env/agents/axi_agent/
ENV_FP			= ../verif/env/top/
SEQ_LIB_FP		= ../verif/tests/sequence_lib/
TEST_FP			= ../verif/tests/src/
TB_TOP_FP		= ../verif/tb/
SRC_FP			= ../src/

###########################################################################
### LIST OF VARIABLES #####################################################
### USE THESE VARIABLES ONLY TO EXECUTE XILINX MODE #######################
###########################################################################

XVLOG			= /tools/Xilinx/Vivado/2021.2/bin/xvlog
XELAB			= /tools/Xilinx/Vivado/2021.2/bin/xelab
XSIM			= /tools/Xilinx/Vivado/2021.2/bin/xsim

###########################################################################
### LIST OF VARIABLES #####################################################
### USE THESE VARIABLES ONLY SAVE LOG FILES ###############################
###########################################################################

SIM_LOG			= -log log/simulate.log
ELAB_LOG		= -log log/elaborate.log
XVLOG_LOG		= -log log/xvlog.log

###########################################################################
### LIST OF COMPILE ORDER #################################################
### USE THESE VARIABLES TO USE IN COMPILE LIST ############################
###########################################################################

COMPILE_LIST		:= $(SRC_FP)SRAM.sv				\
			  $(SRC_FP)axi_mem_slave.sv			\
			  $(SRC_FP)integrate_sram_axi_mem_slave.sv 	\
			  $(SRC_FP)axi_slave_2.sv			\
			  $(SRC_FP)axi_interconnect.sv			\
			  $(SRC_FP)project_dut.sv			\
			  $(AGENT_FP)axi_agent_pkg.sv			\
			  $(ENV_FP)axi_env_pkg.sv			\
			  $(SEQ_LIB_FP)axi_seq_list.sv			\
			  $(TEST_FP)axi_test_list.sv			\
			  $(TB_TOP_FP)axi_interface.sv			\
			  $(TB_TOP_FP)axi_tb_top.sv			\


###########################################################################
### MAKEFILE TARGET #######################################################
###########################################################################
			
STEP_1: 
	@xvlog -sv  ${COMPILE_LIST} $(UVM) -define NO_OF_TRANSACTION=${NO_OF_TRANSACTIONS} 
STEP_2: STEP_1
	@xelab ${TB_TOP} -relax -s top $(TIMESCALE) 
STEP_3: STEP_2
	@xsim top -testplusarg UVM_TESTNAME=${UVM_TESTNAME} -testplusarg UVM_VERBOSITY=${UVM_VERBOSITY} -runall 
clean: 
	@echo "---------------------------------Running Clean--------------------------------" 
	@rm -rf *.jou *.log *.pb *.wdb xsim.dir      				# This deletes all files generated by Vivado
	@rm -rf .*.timestamp                	     				# This deletes all our timestamps
